<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <% include ./commonCss.ejs %>
    <% include ./analytics.ejs %>
  </head>
  <body>
  <header>
    <% include ./header.ejs %>
  </header>

  <main class="container" role="main">
    <div class="filepath div_first">
      <% var keys = Object.keys(hierarchyFiles); %>
      <% if(keys.length > 0){ %>
        <% keys.forEach(function(key, index) { %>
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <button class="btn btn-link btn-card-header" data-toggle="collapse" data-target="#<%= key %>" aria-expanded="false" aria-controls="collapseOne" style="width: 90%;text-align: left;">
                  <i class="collapse-button-show material-icons">expand_less</i>
                  <%= key %>
                </button>
              </h5>
            </div>

            <div id="<%= key %>" class="table-responsive collapse show">
              <table class="table table-striped table-sm card-body">
                <colgroup>
                  <col style="width:80%">
                  <col style="width:10%">
                  <col style="width:10%">
                </colgroup>
                <thead>
                </thead>
                <tbody>
                  <% var files = hierarchyFiles[key]; %>
                  <% if(files.length > 0){ %>
                    <% files.forEach(function(file) { %>
                      <tr>
                        <td style="vertical-align: middle;"><a href="<%= file %>" target="_blank" style="margin-left:5px;overflow: hidden;word-break: break-all;"><%= file %></a></td>
                        <td><button onclick="showJsonButton(event);" class="btn btn-dark btn-sm btn-show-div-edit" style="padding: 5px 10px; margin: 5px 0px;">Show</button></td>
                        <td><button onclick="deleteJsonButton(event);" class="btn btn-danger btn-sm" style="padding: 5px 10px; margin: 5px 0px;">Delete</button></td>
                      </tr>
                    <% }); %>
                  <% } %>
                </tbody>
              </table>
            </div>
          </div>
        <% }); %>
      <% } %>
    </div>

    <div id="div-edit" class="jumbotron json-edit">
      <button type="button" id="btn-close-json-edit" class="btn btn-secondary" style="position: absolute; top: 20px; right: 32px;">X</button>
      <div class="input-group mb-3">
        <input type="text" id="input_json_url" class="form-control" placeholder="JSON API URL" aria-label="JSON API URL" aria-describedby="basic-addon2">
        <div class="input-group-append">
          <button class="btn btn-dark" type="button" onclick="addJsonButton(event);">ADD</button>
        </div>
      </div>

      <div id="jsoneditor"></div>
      <button onclick="validateJsonButton(event);" class="btn btn-dark btn-right">VALIDATE</button>
      <span id="span_validate_result"></span>
    </div>
  </main>
  </body>

  <% include ./commonScript.ejs %>
  <script src="/javascripts/jsoneditor/dist/jsoneditor.min.js"></script>
  <script src="/javascripts/jsonapi.js"></script>
</html>
